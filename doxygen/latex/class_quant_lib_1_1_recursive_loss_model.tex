\doxysection{Quant\+Lib\+::Recursive\+Loss\+Model\texorpdfstring{$<$}{<} copula\+Policy \texorpdfstring{$>$}{>} Class Template Reference}
\hypertarget{class_quant_lib_1_1_recursive_loss_model}{}\label{class_quant_lib_1_1_recursive_loss_model}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}


{\ttfamily \#include $<$recursivelossmodel.\+hpp$>$}

Inheritance diagram for Quant\+Lib\+::Recursive\+Loss\+Model\texorpdfstring{$<$}{<} copula\+Policy \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{class_quant_lib_1_1_recursive_loss_model}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_quant_lib_1_1_recursive_loss_model_adea2b12f9fffc6dbca61c643f4bd9cf6}\label{class_quant_lib_1_1_recursive_loss_model_adea2b12f9fffc6dbca61c643f4bd9cf6} 
{\bfseries Recursive\+Loss\+Model} (const ext\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{class_quant_lib_1_1_constant_loss_latentmodel}{Constant\+Loss\+Latentmodel}}$<$ copula\+Policy $>$ $>$ \&m, \mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} nbuckets=1)
\item 
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model_a8f7410ee19bc4b7f1967c5d2e905feee}{expected\+Tranche\+Loss}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&date) const override
\item 
\Hypertarget{class_quant_lib_1_1_recursive_loss_model_a0ce1964627336bfb2a861d835fa40e7d}\label{class_quant_lib_1_1_recursive_loss_model_a0ce1964627336bfb2a861d835fa40e7d} 
std\+::vector$<$ \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} $>$ {\bfseries loss\+Probability} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&date) const
\item 
std\+::map$<$ \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}}, \mbox{\hyperlink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability}} $>$ \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model_a35437b7b452cc383d8e763480a171106}{loss\+Distribution}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d) const override
\begin{DoxyCompactList}\small\item\em Full loss distribution. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model_ae1eeb7e0d13a942f9ca0bc2740427941}{percentile}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} percentile) const override
\begin{DoxyCompactList}\small\item\em Value at Risk given a default loss percentile. \end{DoxyCompactList}\item 
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model_a7fa9a5e7e3d183775eaf9d4da8a92447}{expected\+Shortfall}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} perctl) const override
\begin{DoxyCompactList}\small\item\em Expected shortfall given a default loss percentile. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{class_quant_lib_1_1_observable}{Quant\+Lib\+::\+Observable}}}
\begin{DoxyCompactItemize}
\item 
{\bfseries Observable} (const \mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \&)
\item 
\mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \& \mbox{\hyperlink{class_quant_lib_1_1_observable_ad1e086da62f05b4bc5eafa698ef6fbc3}{operator=}} (const \mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \&)
\item 
{\bfseries Observable} (\mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \&\&)=delete
\item 
\mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \& {\bfseries operator=} (\mbox{\hyperlink{class_quant_lib_1_1_observable}{Observable}} \&\&)=delete
\item 
void \mbox{\hyperlink{class_quant_lib_1_1_observable_afb67478418efdb94382ac9d7ae904b94}{notify\+Observers}} ()
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model_aa46f9ae4cb4dcab2caa11d5bff41b55b}{reset\+Model}} () override
\begin{DoxyCompactList}\small\item\em Concrete models do now any updates/inits they need on basket reset. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability}} \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_a922ca5f0ea73b3a33420fbcfb2556e93}{prob\+Over\+Loss}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} loss\+Fraction) const
\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual std\+::vector$<$ \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} $>$ \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_ab70b30442fcdda802730fd711c5348da}{split\+Va\+RLevel}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} loss) const
\begin{DoxyCompactList}\small\item\em Associated VaR fraction to each counterparty. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_quant_lib_1_1_default_loss_model_a467843d56b00359a8fa7d0a1017079a5}\label{class_quant_lib_1_1_default_loss_model_a467843d56b00359a8fa7d0a1017079a5} 
virtual std\+::vector$<$ \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} $>$ {\bfseries split\+ESFLevel} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} loss) const
\begin{DoxyCompactList}\small\item\em Associated ESF fraction to each counterparty. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_quant_lib_1_1_default_loss_model_ab57e81d3fdd238c0cb19db2808bc5b59}\label{class_quant_lib_1_1_default_loss_model_ab57e81d3fdd238c0cb19db2808bc5b59} 
virtual \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} {\bfseries density\+Tranche\+Loss} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} loss\+Fraction) const
\begin{DoxyCompactList}\small\item\em \doxylink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability} density of a given loss fraction of the basket notional. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual std\+::vector$<$ \mbox{\hyperlink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability}} $>$ \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_ab8053b0ecb53c758939cf5c7a33fb328}{probs\+Being\+Nth\+Event}} (\mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} n, const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d) const
\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_a25ed3ba8a38c4afaca5dca5b8cfd1d7d}{default\+Correlation}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d, \mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} i\+Name, \mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} j\+Name) const
\begin{DoxyCompactList}\small\item\em Pearsons\textquotesingle{} default probability correlation. \end{DoxyCompactList}\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability}} \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_ab46164d907ae7772c0a5f6788ce4568b}{prob\+At\+Least\+NEvents}} (\mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} n, const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&d) const
\end{DoxyCompactItemize}
\begin{DoxyCompactItemize}
\item 
virtual \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_afd0d4637df1423173d5efc758a16f354}{expected\+Recovery}} (const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&, \mbox{\hyperlink{namespace_quant_lib_af4cc4ef40b52c17cc455ead2a97aedb3}{Size}} i\+Name, const \mbox{\hyperlink{class_quant_lib_1_1_default_prob_key}{Default\+Prob\+Key}} \&) const
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\Hypertarget{class_quant_lib_1_1_recursive_loss_model_ac6833895fef2c3ad22821c8856aaa7c2}\label{class_quant_lib_1_1_recursive_loss_model_ac6833895fef2c3ad22821c8856aaa7c2} 
const ext\+::shared\+\_\+ptr$<$ \mbox{\hyperlink{class_quant_lib_1_1_constant_loss_latentmodel}{Constant\+Loss\+Latentmodel}}$<$ copula\+Policy $>$ $>$ {\bfseries copula\+\_\+}
\end{DoxyCompactItemize}
\doxysubsection*{Protected Attributes inherited from \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model}{Quant\+Lib\+::\+Default\+Loss\+Model}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{class_quant_lib_1_1_relinkable_handle}{Relinkable\+Handle}}$<$ \mbox{\hyperlink{class_quant_lib_1_1_basket}{Basket}} $>$ {\bfseries basket\+\_\+}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$class copula\+Policy$>$\newline
class Quant\+Lib\+::\+Recursive\+Loss\+Model$<$ copula\+Policy $>$}
Recursive STCDO default loss model for a heterogeneous pool of names. The pool names are heterogeneous in their default probabilities, notionals and recovery rates. Correlations are given by the latent model. The recursive pricing algorithm used here is described in Andersen, Sidenius and Basu; "{}\+All your hedges in one basket"{}, Risk, November 2003, pages 67-\/72 \begin{DoxyVerb}Notice that using copulas other than Gaussian it is only an
approximation (see remark on p.68).

\todo Make the loss unit equal to some small fraction depending on the
portfolio loss weights (notionals and recoveries). As it is now this
is ok for pricing but not for risk metrics. See the discussion in O'Kane
18.3.2
\todo Intengrands should all use the inverted probabilities for 
performance instead of calling the copula inversion with the same vals.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\Hypertarget{class_quant_lib_1_1_recursive_loss_model_a7fa9a5e7e3d183775eaf9d4da8a92447}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}!expectedShortfall@{expectedShortfall}}
\index{expectedShortfall@{expectedShortfall}!QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}
\doxysubsubsection{\texorpdfstring{expectedShortfall()}{expectedShortfall()}}
{\footnotesize\ttfamily \label{class_quant_lib_1_1_recursive_loss_model_a7fa9a5e7e3d183775eaf9d4da8a92447} 
template$<$class CP$>$ \\
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model}{Quant\+Lib\+::\+Recursive\+Loss\+Model}}$<$ CP $>$\+::expected\+Shortfall (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&}]{d}{, }\item[{\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}}}]{percentile}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Expected shortfall given a default loss percentile. 



Reimplemented from \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_a60bd1a166744f4de455cae1c1c83f6a1}{Quant\+Lib\+::\+Default\+Loss\+Model}}.

\Hypertarget{class_quant_lib_1_1_recursive_loss_model_a8f7410ee19bc4b7f1967c5d2e905feee}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}!expectedTrancheLoss@{expectedTrancheLoss}}
\index{expectedTrancheLoss@{expectedTrancheLoss}!QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}
\doxysubsubsection{\texorpdfstring{expectedTrancheLoss()}{expectedTrancheLoss()}}
{\footnotesize\ttfamily \label{class_quant_lib_1_1_recursive_loss_model_a8f7410ee19bc4b7f1967c5d2e905feee} 
template$<$class CP$>$ \\
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model}{Quant\+Lib\+::\+Recursive\+Loss\+Model}}$<$ CP $>$\+::expected\+Tranche\+Loss (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&}]{date}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

inv\+Prob.\+push\+\_\+back(\+CP\+::inverse\+Cumulative\+Y(unc\+Def\+Prob\mbox{[}i\mbox{]}, i));//\texorpdfstring{$<$}{<}-\/static call

Reimplemented from \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model}{Quant\+Lib\+::\+Default\+Loss\+Model}}.

\Hypertarget{class_quant_lib_1_1_recursive_loss_model_a35437b7b452cc383d8e763480a171106}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}!lossDistribution@{lossDistribution}}
\index{lossDistribution@{lossDistribution}!QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}
\doxysubsubsection{\texorpdfstring{lossDistribution()}{lossDistribution()}}
{\footnotesize\ttfamily \label{class_quant_lib_1_1_recursive_loss_model_a35437b7b452cc383d8e763480a171106} 
template$<$class CP$>$ \\
std\+::map$<$ \mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}}, \mbox{\hyperlink{namespace_quant_lib_ac41728dd3be3e1869bbb9aec06a89d60}{Probability}} $>$ \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model}{Quant\+Lib\+::\+Recursive\+Loss\+Model}}$<$ CP $>$\+::loss\+Distribution (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&}]{}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Full loss distribution. 



Reimplemented from \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_aeff66ecf317c1dc23713424daf563f88}{Quant\+Lib\+::\+Default\+Loss\+Model}}.

\Hypertarget{class_quant_lib_1_1_recursive_loss_model_ae1eeb7e0d13a942f9ca0bc2740427941}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}!percentile@{percentile}}
\index{percentile@{percentile}!QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}
\doxysubsubsection{\texorpdfstring{percentile()}{percentile()}}
{\footnotesize\ttfamily \label{class_quant_lib_1_1_recursive_loss_model_ae1eeb7e0d13a942f9ca0bc2740427941} 
template$<$class CP$>$ \\
\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}} \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model}{Quant\+Lib\+::\+Recursive\+Loss\+Model}}$<$ CP $>$\+::percentile (\begin{DoxyParamCaption}\item[{const \mbox{\hyperlink{class_quant_lib_1_1_date}{Date}} \&}]{d}{, }\item[{\mbox{\hyperlink{namespace_quant_lib_a372ac5c1a422a6b276fe0552d4d83f50}{Real}}}]{percentile}{}\end{DoxyParamCaption}) const\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [virtual]}}



Value at Risk given a default loss percentile. 



Reimplemented from \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model_ac7142d4e72958aef5a602167a138973e}{Quant\+Lib\+::\+Default\+Loss\+Model}}.

\Hypertarget{class_quant_lib_1_1_recursive_loss_model_aa46f9ae4cb4dcab2caa11d5bff41b55b}\index{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}!resetModel@{resetModel}}
\index{resetModel@{resetModel}!QuantLib::RecursiveLossModel$<$ copulaPolicy $>$@{QuantLib::RecursiveLossModel$<$ copulaPolicy $>$}}
\doxysubsubsection{\texorpdfstring{resetModel()}{resetModel()}}
{\footnotesize\ttfamily \label{class_quant_lib_1_1_recursive_loss_model_aa46f9ae4cb4dcab2caa11d5bff41b55b} 
template$<$class CP$>$ \\
void \mbox{\hyperlink{class_quant_lib_1_1_recursive_loss_model}{Quant\+Lib\+::\+Recursive\+Loss\+Model}}$<$ CP $>$\+::reset\+Model (\begin{DoxyParamCaption}{}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [override]}, {\ttfamily [protected]}, {\ttfamily [virtual]}}



Concrete models do now any updates/inits they need on basket reset. 



Implements \mbox{\hyperlink{class_quant_lib_1_1_default_loss_model}{Quant\+Lib\+::\+Default\+Loss\+Model}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
ql/experimental/credit/recursivelossmodel.\+hpp\end{DoxyCompactItemize}
